Purpose|Target schema|Target table|Src_schema|Src_table|Alias|Type|Join type|on Condition|Where|Set|Src file name|Call Params|Columns|Max_cdc_date
|prd_db_stg|gtt_oprt_lost||||Insert|||||test1.sql||[src_system_id, oprt_type_id, day_id, whs_id, art_id, lost_whs_type_id, oprt_id, src_oprt_art_id, cntr_id, is_suppl_define, suppl_type, is_priority, qnty, oprt_sum, oprt_sum_wo_nds, oprt_sum_tz, oprt_sum_tz_wo_nds]|
|||prd_db_dm|d_oprt_lost_corr|u|Select|||where u.is_use = 1  and  u.day_id between v_calc_begin_dt and v_calc_end_dt  and  u.lost_corr_type_id = 1  and  u.is_prc_delete = 0  and  u.is_user_delete = 0  and  (u.resp_qnty is  null   or  u.resp_oprt_sum is  null   or  u.resp_oprt_sum_wo_nds is  null   or  u.resp_oprt_sum_tz is  null   or  u.resp_oprt_sum_tz_wo_nds is  null )||test1.sql||[day_id, oprt_id, src_oprt_art_id, corr_qnty, corr_oprt_sum, is_use, v_calc_begin_dt, v_calc_end_dt, lost_corr_type_id, is_prc_delete, is_user_delete, resp_qnty, resp_oprt_sum, resp_oprt_sum_wo_nds, resp_oprt_sum_tz, resp_oprt_sum_tz_wo_nds]|
|||prd_vd_rdv|v_oprt_art_l|op|Select|inner|op.oprt_dt = u.day_id  and  op.dwh_oprt_id = u.oprt_id  and  op.src_oprt_art_id = u.src_oprt_art_id|where op.dwh_oprt_type_prn_id in (30,42,44,32)  and  (lcr.cntr_type = 0  or  (lcr.cntr_type > 0  and  (lcr.cntr_type = cntr.is_external_cntr  or  lcr.cntr_type = cntr.is_rc_cntr  or  lcr.cntr_type = cntr.is_whs_cntr)))  and  (lcr.is_suppl_define = 1  or  (lcr.is_suppl_define = 0  and  lcr.suppl_type = 0)  or  (lcr.is_suppl_define = 0  and  lcr.suppl_type > 0  and  COALESCE(op.dwh_cntr_id,-1) <> -1  and  (lcr.suppl_type = COALESCE(cntr.is_rc_cntr,-1)  or  lcr.suppl_type = COALESCE(cntr.is_external_cntr,-1)  or  lcr.suppl_type = COALESCE(cntr.is_whs_cntr,-1))))  and  op.oprt_dt between v_calc_begin_dt and v_calc_end_dt||test1.sql||[oprt_dt, dwh_oprt_id, src_oprt_art_id, dwh_art_id, dwh_whs_id, dwh_src_system_id, dwh_oprt_type_id, dwh_cntr_id, pricebuy, nds_fact_pct, pricebuy_wo_nds, pricebuy_tz, pricebuy_tz_wo_nds, dwh_oprt_type_prn_id]|
|||prd_db_stg|gtt_art_cross_whs|acw|Select|inner|op.dwh_art_id = acw.art_id  and  op.dwh_whs_id = acw.whs_id  and  op.dwh_src_system_id = acw.src_system_id|where op.dwh_oprt_type_prn_id in (30,42,44,32)  and  (lcr.cntr_type = 0  or  (lcr.cntr_type > 0  and  (lcr.cntr_type = cntr.is_external_cntr  or  lcr.cntr_type = cntr.is_rc_cntr  or  lcr.cntr_type = cntr.is_whs_cntr)))  and  (lcr.is_suppl_define = 1  or  (lcr.is_suppl_define = 0  and  lcr.suppl_type = 0)  or  (lcr.is_suppl_define = 0  and  lcr.suppl_type > 0  and  COALESCE(op.dwh_cntr_id,-1) <> -1  and  (lcr.suppl_type = COALESCE(cntr.is_rc_cntr,-1)  or  lcr.suppl_type = COALESCE(cntr.is_external_cntr,-1)  or  lcr.suppl_type = COALESCE(cntr.is_whs_cntr,-1))))  and  op.oprt_dt between v_calc_begin_dt and v_calc_end_dt||test1.sql||[art_id, whs_id, src_system_id, lost_whs_type_id, grp_art_id, is_sp]|
|||prd_db_stg|gtt_lost_struct|lcr|Select|inner|op.dwh_oprt_type_id = lcr.oprt_type_id  and  acw.lost_whs_type_id = lcr.lost_whs_type_id  and  acw.grp_art_id = lcr.grp_art_id  and  (lcr.is_sp = -1  or  (lcr.is_sp <> -1  and  lcr.is_sp = acw.is_sp))|where op.dwh_oprt_type_prn_id in (30,42,44,32)  and  (lcr.cntr_type = 0  or  (lcr.cntr_type > 0  and  (lcr.cntr_type = cntr.is_external_cntr  or  lcr.cntr_type = cntr.is_rc_cntr  or  lcr.cntr_type = cntr.is_whs_cntr)))  and  (lcr.is_suppl_define = 1  or  (lcr.is_suppl_define = 0  and  lcr.suppl_type = 0)  or  (lcr.is_suppl_define = 0  and  lcr.suppl_type > 0  and  COALESCE(op.dwh_cntr_id,-1) <> -1  and  (lcr.suppl_type = COALESCE(cntr.is_rc_cntr,-1)  or  lcr.suppl_type = COALESCE(cntr.is_external_cntr,-1)  or  lcr.suppl_type = COALESCE(cntr.is_whs_cntr,-1))))  and  op.oprt_dt between v_calc_begin_dt and v_calc_end_dt||test1.sql||[oprt_type_id, lost_whs_type_id, grp_art_id, is_sp, cntr_type, is_suppl_define, suppl_type, is_priority, qnty_coef, opsum_coef, cp_sum_coef]|
|||prd_db_stg|gtt_lost_rc|rc|Select|left|acw.whs_id = rc.whs_id  and  acw.lost_whs_type_id = 0|where op.dwh_oprt_type_prn_id in (30,42,44,32)  and  (lcr.cntr_type = 0  or  (lcr.cntr_type > 0  and  (lcr.cntr_type = cntr.is_external_cntr  or  lcr.cntr_type = cntr.is_rc_cntr  or  lcr.cntr_type = cntr.is_whs_cntr)))  and  (lcr.is_suppl_define = 1  or  (lcr.is_suppl_define = 0  and  lcr.suppl_type = 0)  or  (lcr.is_suppl_define = 0  and  lcr.suppl_type > 0  and  COALESCE(op.dwh_cntr_id,-1) <> -1  and  (lcr.suppl_type = COALESCE(cntr.is_rc_cntr,-1)  or  lcr.suppl_type = COALESCE(cntr.is_external_cntr,-1)  or  lcr.suppl_type = COALESCE(cntr.is_whs_cntr,-1))))  and  op.oprt_dt between v_calc_begin_dt and v_calc_end_dt||test1.sql||[whs_id, src_system_id, whs_prn_id]|
|||prd_db_stg|gtt_lost_cntr|cntr|Select|left|(lcr.cntr_type > 0  or  (lcr.is_suppl_define = 0  and  lcr.suppl_type > 0))  and  COALESCE(op.dwh_cntr_id,-1) = cntr.cntr_id|where op.dwh_oprt_type_prn_id in (30,42,44,32)  and  (lcr.cntr_type = 0  or  (lcr.cntr_type > 0  and  (lcr.cntr_type = cntr.is_external_cntr  or  lcr.cntr_type = cntr.is_rc_cntr  or  lcr.cntr_type = cntr.is_whs_cntr)))  and  (lcr.is_suppl_define = 1  or  (lcr.is_suppl_define = 0  and  lcr.suppl_type = 0)  or  (lcr.is_suppl_define = 0  and  lcr.suppl_type > 0  and  COALESCE(op.dwh_cntr_id,-1) <> -1  and  (lcr.suppl_type = COALESCE(cntr.is_rc_cntr,-1)  or  lcr.suppl_type = COALESCE(cntr.is_external_cntr,-1)  or  lcr.suppl_type = COALESCE(cntr.is_whs_cntr,-1))))  and  op.oprt_dt between v_calc_begin_dt and v_calc_end_dt||test1.sql||[cntr_id, is_external_cntr, is_rc_cntr, is_whs_cntr]|

